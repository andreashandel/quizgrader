---
title: "quizgrader Tutorial"
author: "<a href=https://www.andreashandel.com>Andreas Handel</a>"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette:
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{quizgrader Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



## Summary
This package allows auto-grading of quizzes and is meant as an alternative to this functionality within standard learning management systems (LMS).


## Motivation

I regularly teach online. In the past, I have used our university's LMS, but I dislike it because it is not user-friendly and elements, such as quizzes and student submissions are "locked up" inside the LMS and one can only extract very rudimentary statistics. Because of this, I have over the last years slowly moved away from our LMS and tried to replace as much as possible with open, or at least user-friendly resources.

One feature I liked about the LMS is that it could auto-grade quizzes, so once the quiz was written, I didn't have much to do anymore, students just submitted and got graded automatically each week. I tend to give lots of small quizzes (generally 1-2 per week), so I needed this process automated.

I decided to write some R code to get the functionality I needed. It turned out well enough that I figured it could be worth turning it into a full `R` package and making it available to others.



## Installation
After having installed and opened R/Rstudio, you can install the package from CRAN by typing the following into the R console (the bottom left window if you are using RStudio):

```{r, eval=FALSE, echo=TRUE}
install.packages('quizgrader')
```



Alternatively, you can install the latest development version (with usually both more features and more bugs) from github, using the `remotes` package. The following commands, typed into the `R` console, will get you up and running:

```{r, eval=FALSE, echo=TRUE}
install.packages('remotes') #if not already installed
remotes::install_github('andreashandel/quizgrader')
```


The package depends on other packages, which will also be installed as needed. Package installation is a one-time process, unless you update or re-install R itself, or want to install a newer version of `quizgrader`. 



## Main use

The main use of this package is through Shiny apps, both locally for the instructor to manage the quizzes and remotely, through `shinyapps.io` deployment for students to go to a website and upload their quizzes, which will be instantly auto-graded and students will receive feedback. The following documentation focuses on that use-case, but it also explains what goes on behind the scenes and how some components could be done without `Shiny` apps. Towards the end of this document, a few other ways of using this package are described.



## Getting started

Start by loading the package with `library(quizgrader)`. 
You can then start the main menu, which is a shiny app, with `quizmanager()`.
In the app, click on `Start new course`, this will ask you to specify a location where you want to have the main folder and sub-folders created.

Alternatively, without starting the `quizmanager` shiny menu, from the command line you can start a new course with 

```{r, eval=FALSE, echo=TRUE}
start_course(coursename = "yourcoursename", courselocation = "path/to/location/for/course")
```

You are required to provide a name for your course (which will be the name of the main directory). It is recommended you provide a location where you want the course folder and its subfolders to go. If you do not provide that, it will be created in the current directory.

Either with the shiny app or the command line, if things go wrong, you'll get an error message. Otherwise, if things went well, there should be a new folder with the course name you specified in the location you chose. Inside that folder are several other folders and files, namely:

* `/studentlists` - a folder that contains spreadsheets (template and filled ones) with student information. At the start, this folder will contain the file `studentlist_template.xlsx` which is a file that should be populated with student information, as described below. 
* `/courselists` - a folder that will contain the main tracking spreadsheets.
* `/complete_quizzes` - a folder which will contain all your quizzes (with answers) once you made them. Initially, this folder contains the file `quiz_template.xlsx`, which should be used as template for creating your own quizzes, as described below. 
* `/student_quizzes` - a folder that will contain quizzes to be given to the students for filling out and submitting. These files are auto-generated once you made your solution sheets.
* `/submissions` - all individual submissions by students. This is mainly for record keeping and to run some question- and student-specific stats. For easier organization, a sub-folder for each quiz will be created and student submissions organized into those sub-folders.



## Add students to the course

Once you created the course as described above, you need to add students to the course. To that end, you need to fill out a provided template with student information.
You can get this file by either clicking on `Get studentlist template` inside the shiny app, or manually navigating to the `/studentlists` folder where you'll find the `studentlist_template.xlsx` file. 
There are 4 columns that you need to fill out. `Lastname` and `Firstname` should be self-explanatory.

The `ID` needs to be a unique identifier for each student, and will be checked/matched when a student uploads their quiz. (Matching is not done on names since those can be non-unique. The ID needs to be something unique for each student.) The best option is probably to use student emails, but any other ID works as well.

The `Password` column is there to prevent a student accidentally or purposefully submitting something as another student. Of course this does not prevent cheating. If students want to, they can share passwords and submit for each other. Or they can send each other their filled out forms. **If you are worried about cheating, this package/setup is likely not for you!** Thus, it is not meant to prevent cheating, only the possibility that a student might try to submit as someone else (provided students keep their passwords to themselves). I collect passwords at the beginning of the course through a simple Google form. However you collect them, you then need to copy the passwords to this sheet. **Clearly tell the students that you will see their password and that they should use a simple _throw-away_ password for this course and not any passwords they use to protect real systems!** Fully disabling the password feature is not possible, but if you don't want to use one, just pick the same word for every student and tell the students what the password is. They'll still have to enter it during submission, but that should not be much of a nuisance.

**You need to provide the columns that are shown in the template.** If you want to add further columns to this spreadsheet, you can do so. They should not interfere with the working of the app and will be ignored.

Once you filled out the template with the student information, add it to the system by clicking the `Add studentlist` button or running

```{r, eval=FALSE, echo=TRUE}
add_studentlist(coursename = "yourcoursename", studentfilelocation = "/location/to/file")
```

This will take the file you made and place it into the `/studentlist` folder with a time-stamp. If you do this again at a later time, a new file with a newer time-stamp is created. Thus, all previous student lists are preserved, but only the most recent one is being used to generate the main quiz grade tracking list (as described below).


## Create your quizzes 

To create quizzes, use the template that is provided.
You can get the template by clicking `Get quiz template` in the `quizmanager` menu, or by manually going into the `complete_quizzes` folder of your course.

For each quiz you want to make, you need to create one file based on the template, they should all be structured as shown in the template. 
The name of the quiz files does not matter, though I recommend a systematic naming scheme, e.g. file names that agree with the quizID (see below). 


### Quiz Columns

Each quiz needs to have the following columns

#### QuizID

A unique ID containing letters/numbers. Only the entry in the first row matters, anything else in further rows is ignored. It cannot be empty. Avoid blank spaces and special characters. They might work, but it's not guaranteed. I also recommend naming the quiz file in accordance with the unique ID (e.g. the ID is `mod1quiz1` and the file is `mod1quiz1.xlsx`) but that is not required.

#### Duedate

A date on which the quiz is due. Only the entry in the first row matters, anything else in further rows is ignored. It cannot be empty. It should be coded as a text (don't allow Excel to transform it into a date) and follow the ISO standard, i.e. be of the form YEAR-MO-DA (e.g. 2021-05-18). Specific due times are currently not implemented, thus students have until midnight of the due date to submit. If you very much want/need time, let me know and I can implement that. If quizzes can be submitted any time, just set a due date very far into the future.


#### Attempts

Number of submission attempts students can make.  Only the entry in the first row matters, anything else in further rows is ignored. It needs to be a positive integer. Note that currently, any new submission will overwrite previous ones (which means if a student did worse on a subsequent attempt, that lower score will be recorded). If you need unlimited submission attempts, set this to a very large number.


#### QuestionID

A unique ID for each question. I recommend combining quiz ID with some additional question ID (e.g. `mod1quiz1q1`, `mod1quiz1q2`, etc). Needs to be different for each question.


#### Question

The question text. You can use basic formatting, e.g. line breaks and such. Fancy formatting, e.g. equations or pictures or such is currently not supported (and unlikely will be). If you need to provide additional information, you can include a link to a URL into the question, or provide the quiz in the context of other materials which can contain anything else.


#### Answer

The correct answer to the question. Write it in exactly the way you want students to specify it. See the next section for more details.


#### Type

Type of question/answer. Several types are currently allowed. Depending on the type, answers are evaluated differently, as follows:

**Character:** A single character is expected and only the first character is evaluated. Capitalization is ignored. This means if the answer is `A` and the student provides `A)` or anything that starts with either `A` or `a` it will be marked as `correct`, otherwise `not correct`. Good for multiple choice.

**Text:** Matches text provided by student with answer text. Leading and trailing white spaces are trimmed in the submission and capitalization is ignored, but otherwise matching is strict. Thus, if the answer is `hello world` and the student submits `hello  world` (extra white space), it would be marked as `not correct`. So use this type of question/answer with care, as it is easy for there to be a non-match based on benign reasons, e.g. a simple typo.
       
**Logical:** The student is expected to write either `TRUE` or `FALSE`. Also allowed are `Yes` and `No` and `1` and `0`. Only the first character is evaluated and capitalization is ignored. Thus, if a student enters anything starting with `t`, `y` or `1` it will be interpreted to mean `TRUE`. Similarly, `f`, `n` and `0` are evaluated to mean `FALSE`.  Anything else is interpreted as an incorrect submission and labeled 'not correct'. 

**Integer:** Whatever the student provides is rounded to the nearest integer, then compared with the answer. So if the answer is 42 and the student provides 41.5 or 42.4, that's evaluated as correct, 41.4 would be evaluated as wrong. So would `41` or `43`. Any submitted answer that can't be converted to numeric is labeled 'not correct'.

**Fuzzy_Integer:** As for `Integer`, whatever the student provides is rounded to the nearest integer, then compared with the answer. The difference is that this type also allows for a plus/minus 1 difference. This is done in case students don't know how to round and you don't want to penalize them for that. So if the answer is 42 and the non-rounded answer the student gets is 41.5 and they round it - wrongly - to 41, it would still be considered correct. Any submitted answer that can't be converted to numeric is labeled 'not correct'.

When to  use `Fuzzy_Integer` or `Integer`: If you know the answer is an integer, e.g. if the question is `how many US states are there` and the right answer is `50`, you don't want to allow `49` or `51` to be considered correct, so you should use the `Integer` type. If on the other hand you ask students to do some calculation and the result is `41.50123` and you want them to round it to an integer, if you want to be strict and only allow proper rounding (i.e. `42`) you should use `Integer` type, if you are ok with them making rounding mistakes, you should use `Fuzzy_Integer` which would also accept `41` as correct (A submission of `40.567` would also be considered corret, since the number is first rounded to an integer, then checked if it is within plus/minus 1 of the correct answer). 
**Numeric:** An exact numeric value. Submission is directly compared to answer. Any submitted answer that can't be converted to numeric is labeled 'not correct'.

**Rounded_Numeric:** An numeric value rounded to some specified significant digits. Those digits need to match the provided answer. Thus if the answer is `42.42`, you should specify that students need to round to 2 significant digits. This again allows for non-proper rounding, e.g. if a student gets `42.4163` and mistakenly rounds it to `42.41` it will still be considered as correct. If you don't want that and want to be strict, use the **Numeric** type.


_A note on answer types: I implemented those that I use for my own teaching. If you have others that you want/need, please let me know. Most of them should not be too hard to implement and I'd be happy to do so (if reasonably easy to do)._

#### Instruction

Provide additional instructions to the students, e.g. instructions regarding rounding, entering an integer, etc.

#### Comment

These are any notes/comments you want to add, mostly for yourself.

#### Feedback

This is optional feedback that will be provided to the student together with the `Correct`/`Not Correct` label for each question.


### Notes for quiz creation

I assume you'll be making your quiz sheets using Excel or similar (e.g. LibreOffice). These programs are sometimes overly eager when it comes to formatting. The safest approach is to format all cells as text. When these quiz sheets are read in, each cell is read as text and then internally converted (to e.g. a date or a numeric value). If you allow the spreadsheet software to do formatting, things might go wrong (e.g. if you read in a date format from Excel as text, it often shows up wrong). Always test your quizzes before giving them to students.


## Add your quizzes

Once you created your quizzes, including answers, you need to place them into the `complete_quizzes` folder.
This can be done manually by just copying the files into the folder. Alternatively, you can press the `Add quizzes to course` button in the GUI.



## Creating student quiz sheets

Now it's time to create quiz sheets that will be given to students. First, make sure that the only files in the `complete_quizzes` folder are your quizzes, any other files need to be removed. Once that's the case, you can press the `Create student quiz files` button in the GUI, or run:

```{r, eval=FALSE, echo=TRUE}
generate_student_sheets(coursename = "yourcoursename", courselocation = "path/to/location/for/course")
```

This generates for each quiz sheet in the `complete_quizzes` folder a matching sheet to be given to students. 
The student sheets will contain the columns `QuizID`, `QuestionID`, `Question`, `Instruction` and an empty `Answer` column.
The remaining columns will not be included in the student sheets. 

You can find all the student files in the `student_quizzes` folder. You can then distribute these files to the students by any means you like (e.g. email, Dropbox, posting to a course website, etc.). Students will fill out the quiz sheets by entering their answers into the `Answer` column, and then submit them through the online submission app.

If you make new quizzes, you can keep adding them to the `complete_quizzes` folder and then re-generating the student quizzes. The files for the students are based on whatever the latest version of the quizzes are found in the `complete_quizzes` folder. Thus, if you find mistakes in your quizzes or want to make other adjustments, fix them in the main/complete quiz file, then re-generate the student versions and re-distribute.


## Creating the main course tracking document

Once you made all quizzes and filled in the `courselist_template.xlsx` with the student information, run the following command to generate the main spreadsheet `courselist.xlsx` which will be used to record all grades:

```{r, eval=FALSE, echo=TRUE}
generate_courselist(coursename = "yourcoursename", courselocation = "path/to/location/for/course")
```

This command will take the student information you entered into the `courselist_template.xlsx` file, then go through each quiz in the 


_Note that if the student roster changes, or if you add further quizzes, you can always re-run the two commands that generate the student quiz sheets and the course list. Once the course has started and students are beginning to submit, things get trickier (FIGURE OUT HOW TO DO THAT)_



## Deploying the student submission app

Students are given the quiz sheets, asked to fill them, and then submit them online. 
The online submission system is powered by another Shiny app and functionality of the `quizgrader` package. 

The following assumes that you will be hosting the submission system on RStudio's `shinyapps.io` service. For alternatives, see the end of the document.

You can deploy everything with this command.

```{r, eval=FALSE, echo=TRUE}
deploy_quizgrader()
```

This function takes the submission app file, the 
and places them to the Shiny server. Students should now be able to go to the website (e.g. shinyapps.io`) and, after entering their identifying information, upload their quiz. 
The submission will be checked to make sure it is not past the due date or the number of allowed submissions has been exceeded. Then the quiz is graded by comparing the student submissions with those in the complete quiz files, the grade is recorded in the form of a score, and students are provided with immediate feedback on which questions they did get right and which they didn't. Anything entered into the `feedback` column is also displayed. In addition, students can see information about their cumulative performance so far. 



Note that as long as any password is missing from the student list, the app will display a `not ready for submission` message. 


## Alternative use cases

The above approach assumes you will use `shinyapps.io` as the service to host your grading app and where students go to submit their quizzes. There are two other ways I can think of to use the package (there might be more, if you got an interesting one, I'd love to hear about it!) 


### On your own Shiny server

Almost the same setup as described above works if you host your own shiny server. That's how I implemented it in the past. You just have to manually place the submission app and the various folders on the server. If you know how to operate and administer a shiny server, I assume it will be clear how to run this. Just make sure the file and folder permissions are set ok, since students (the app) need to be able to write their files to the server. Every so often, I recommend pulling files from the server. If you are trying to run it on your own shiny server and get stuck, feel free to reach out so I can help.


### Semi-automated

If for some reason you do not want to use a web-based submission for students, you could instead ask students to send (email or otherwise) their solution files. 

You will then need to place them into the submissions folder. You will also need to give each quiz a name that starts with the student ID and then some unique name (ideally the quiz ID, but that's not required since it's inside the file). So if e.g. Anna Jones (ajones@abc.edu) submits her module 3 quiz, you might want to name it (or ask them to) as `ajones@abc.edu_mod3quiz1.xlsx`. Starting with their student ID followed by `_` is required. 

You can then run the function following command to grade all the submissions in a folder and add to the main grading sheet

```{r, eval=FALSE, echo=TRUE}
grade_submissions(submissionfolder = "path/to/location/for/submissions")
```

Note that with this approach, using automated due date and submission attempt checks makes little sense, thus you should set those to a far away date and many attempts in the quiz sheets and you'll need to manually keep track of when they sent the file to you.

Overall, this approach still requires a lot of manual intervention, and I'm thus not sure it's a worthwhile approach, I would then probably stick with the LMS, try the web-based approach as described, or find some other way of doing it.




## Further thoughts and comments for using the package


### Privacy, Security and FERPA

You might want to think about privacy and security as it applies to various laws (e.g. FERPA) when using this app. You will be placing a list with student names, IDs (e.g. emails) and their quiz submissions/grades into the cloud. There is no public access to any of this information, you (or TAs who have login privileges) are the only one who can access those documents. It thus seems ok to me. But if the server where you host the submission app gets compromised, this might compromise student information. I consider this a low and small risk, but it's something you might want to think about.



### Manual submissions

It's not unlikely that a student misses a deadline, or you allow them to submit again, or some other circumstance occurs that needs special permission. You could go into the `courselist` file and adjust to allow for that (e.g. change the due date for that student, or manually adjust). This is possible but risky, as things might break. My approach is to tell those students to send (email) me their quiz sheet in question, and when I make final grades I will then manually grade their quiz and edit the `courselist` file to add their scores.


WRITE grade_submissions() function such that it can autograde manual submissions?


## Contributing to the package
The package is on GitHub and you can use the usual GitHub process to file bug reports, send feature requests, contribute updates and bug fixes, etc. If you have any comments or feedback, I very much welcome them. Please file a [GitHub issue](https://github.com/andreashandel/quizgrader/issues) and let me know what you think.


## Further information

## Contributors
This R package is developed and maintained by [Andreas Handel](https://www.andreashandel.com). A full list of contributors [can be found here](https://andreashandel.github.io/quizgrader/authors.html).

## Citation


## References
